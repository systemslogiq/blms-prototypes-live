import{j as e,R as I,r as o}from"./index-DRa8kFrC.js";import{L as mt}from"./layers-D7t4G0e4.js";import{S as xt}from"./sliders-horizontal-CTk6HNYP.js";import{C as ht,S as pt}from"./shield-BKI9vguE.js";import{F as Ae,a as ut,c as ft,g as ie}from"./mockData-B1Jrjs4s.js";import{C as bt,f as Ie}from"./helpers-DLa8_y9v.js";import{c as ce,X as Te}from"./x-CxXyrueu.js";import{C as oe,L as Z}from"./layout-grid-CjTeQ3Sd.js";import{B as gt}from"./book-open-BuB0_FQm.js";import{U as De,S as Pe,P as Le}from"./user-BTDoZBOp.js";import{R as jt,L as Re,T as Be,C as Fe,a as yt,P as Nt,b as _e,c as vt,d as wt,O as Me,e as $e,D as Oe}from"./index-Cm1rnY_v.js";import{S as U}from"./statusConfig-j4-cdvFl.js";import{F as kt}from"./file-text-Y-n7Cqol.js";import{T as re}from"./trash-2-L38Nf8bc.js";import{P as ze}from"./plus-O_WDV1z3.js";import{S as fe}from"./square-check-big-DIvO0DUh.js";import{C as Ct}from"./chevron-down-CW_UZIU5.js";import{M as He}from"./map-pin-DQ603-UI.js";import{c as St,P as Et,a as de,u as At,b as Ue,d as be}from"./Combination-35F0LGH-.js";import{u as It,R as Ve,V as Tt,S as Dt,T as Pt}from"./index-Cc_6wC72.js";import{u as Lt}from"./index-DgaAmBDh.js";import{C as Rt}from"./check-Cr0AI4io.js";import{S as Bt}from"./send-B322_d3t.js";const Ft=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],qe=ce("clipboard-check",Ft);const _t=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ke=ce("clock-3",_t);const Mt=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],$t=ce("sparkles",Mt),Ot=[{id:"platform",label:"Platform services",icon:mt},{id:"parameter-master",label:"Parameter Master",icon:xt},{id:"manual-entry",label:"Manual & Lab entry",icon:ht},{id:"filter-studio",label:"Filter Studio",icon:Ae},{id:"dashboards",label:"Dashboards",icon:bt},{id:"reporting",label:"Reporting & exports",icon:qe},{id:"campaigns",label:"Campaigns",icon:oe},{id:"shift-book",label:"Shift Book",icon:gt},{id:"admin",label:"Administration",icon:pt}];function Ge({activeId:t="shift-book",orientation:a="horizontal",labels:s}){const l=a==="vertical";return e.jsx("nav",{className:l?"flex flex-col gap-1":"inline-flex flex-wrap items-center gap-1.5 rounded-full bg-slate-950/80 px-2 py-1",children:Ot.map(n=>{const c=n.id===t,d=n.icon,h=s?.[n.id]||n.label;return e.jsxs("button",{type:"button",className:["inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-[11px] font-medium transition-colors",l?"w-full justify-start":"",c?"bg-sky-600 text-white shadow-sm":"bg-slate-900/80 text-slate-300 hover:bg-slate-800/80"].join(" "),children:[d&&e.jsx(d,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:h})]},n.id)})})}function zt({t,theme:a,setTheme:s,language:l,setLanguage:n}){return e.jsx("header",{className:"slv4-header border-b border-slate-900 bg-slate-950/80 backdrop-blur",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.25em] text-sky-400",children:t.headerKicker}),e.jsx("h1",{className:"mt-1 text-xl font-semibold",children:t.headerTitle}),e.jsx("p",{className:"mt-1 max-w-xl text-xs slv4-shell-text-subtle text-slate-400",children:t.headerTagline})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 text-xs text-slate-400",children:[e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(De,{className:"h-3.5 w-3.5 text-slate-300"}),e.jsx("span",{children:t.shiftLabel})]}),e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsxs("div",{className:"inline-flex items-center rounded-full bg-slate-900/80 p-0.5",children:[e.jsx("button",{type:"button",onClick:()=>s("dark"),className:`px-2 py-0.5 text-[11px] ${a==="dark"?"rounded-full bg-slate-700 text-slate-50":"text-slate-400"}`,children:t.themeDark}),e.jsx("button",{type:"button",onClick:()=>s("light"),className:`px-2 py-0.5 text-[11px] ${a==="light"?"rounded-full bg-slate-700 text-slate-50":"text-slate-400"}`,children:t.themeLight})]}),e.jsxs("div",{className:"inline-flex items-center rounded-full bg-slate-900/80 p-0.5",children:[e.jsx("button",{type:"button",onClick:()=>n("en"),className:`px-2 py-0.5 text-[11px] ${l==="en"?"rounded-full bg-slate-700 text-slate-50":"text-slate-400"}`,children:t.langEn}),e.jsx("button",{type:"button",onClick:()=>n("de"),className:`px-2 py-0.5 text-[11px] ${l==="de"?"rounded-full bg-slate-700 text-slate-50":"text-slate-400"}`,children:t.langDe})]})]})]})]}),e.jsx("div",{className:"mt-3 hidden md:block",children:e.jsx(Ge,{activeId:"shift-book",labels:{platform:"Platform services","parameter-master":"Parameter Master","manual-entry":"Manual & Lab entry","filter-studio":"Filter Studio",dashboards:"Dashboards",reporting:"Reporting & exports",campaigns:"Campaigns","shift-book":l==="de"?"Schichtbuch":"Shift Book",admin:"Administration"}})})]})})}function j(...t){return t.filter(Boolean).join(" ")}function J(t){return t?new Date(t).toLocaleString(void 0,{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"—"}function Ht(t){return t?new Date(t).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"}):"—"}const Ut="slv4-badge inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold",ge={default:"slv4-badge-default",secondary:"slv4-badge-secondary",muted:"slv4-badge-muted",success:"slv4-badge-success",warning:"slv4-badge-warning",danger:"slv4-badge-danger"},me=I.forwardRef(({className:t,variant:a="default",...s},l)=>e.jsx("span",{ref:l,className:j(Ut,ge[a]||ge.default,t),...s}));me.displayName="Badge";const X=I.forwardRef(({className:t,type:a="text",...s},l)=>e.jsx("input",{ref:l,type:a,className:j("flex h-9 w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-1 text-sm text-slate-50 shadow-sm placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:cursor-not-allowed disabled:opacity-50",t),...s}));X.displayName="Input";const xe=jt,se=I.forwardRef(({className:t,...a},s)=>e.jsx(Re,{ref:s,className:j("slv4-tabs-list inline-flex h-8 items-center justify-center gap-1 rounded-full px-1 text-[11px] font-medium",t),...a}));se.displayName=Re.displayName;const R=I.forwardRef(({className:t,...a},s)=>e.jsx(Be,{ref:s,className:j("slv4-tabs-trigger inline-flex items-center justify-center whitespace-nowrap rounded-full px-3 py-1 text-[11px] font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 focus-visible:ring-offset-transparent",t),...a}));R.displayName=Be.displayName;const V=I.forwardRef(({className:t,...a},s)=>e.jsx(Fe,{ref:s,className:j("mt-3 focus:outline-none",t),...a}));V.displayName=Fe.displayName;const We=yt,Vt=wt,qt=Nt,Qe=I.forwardRef(({className:t,...a},s)=>e.jsx(Me,{ref:s,className:j("fixed inset-0 z-40 bg-black/60 backdrop-blur-sm",t),...a}));Qe.displayName=Me.displayName;const he=I.forwardRef(({className:t,children:a,theme:s="dark",...l},n)=>e.jsx(qt,{children:e.jsxs("div",{className:j("shiftlog-v4",s==="light"?"is-light":"is-dark"),children:[e.jsx(Qe,{}),e.jsxs(_e,{ref:n,className:j("fixed left-1/2 top-1/2 z-50 w-full max-w-3xl -translate-x-1/2 -translate-y-1/2 rounded-xl border border-slate-700 bg-slate-950 px-6 py-5 shadow-xl focus:outline-none",t),...l,children:[a,e.jsx(vt,{className:"absolute right-4 top-4 rounded-full p-1 text-slate-400 hover:bg-slate-800 hover:text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.jsx(Te,{className:"h-4 w-4"})})]})]})}));he.displayName=_e.displayName;const Kt=({className:t,...a})=>e.jsx("div",{className:j("flex flex-col space-y-1.5 text-left",t),...a}),Xe=I.forwardRef(({className:t,...a},s)=>e.jsx($e,{ref:s,className:j("text-lg font-semibold leading-tight",t),...a}));Xe.displayName=$e.displayName;const Ye=I.forwardRef(({className:t,...a},s)=>e.jsx(Oe,{ref:s,className:j("text-sm text-slate-400",t),...a}));Ye.displayName=Oe.displayName;const Gt={default:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-slate-800 text-slate-50 hover:bg-slate-700",outline:"border border-slate-600 text-slate-100 hover:bg-slate-800 hover:border-slate-500",ghost:"bg-transparent text-slate-200 hover:bg-slate-800",destructive:"bg-red-600 text-white hover:bg-red-700",link:"bg-transparent text-blue-400 hover:underline px-0"},Wt={default:"h-9 px-4",sm:"h-8 px-3 text-xs",lg:"h-10 px-6",icon:"h-9 w-9 p-0"},_=I.forwardRef(({className:t,variant:a="default",size:s="default",...l},n)=>e.jsx("button",{ref:n,className:j("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-slate-950 disabled:opacity-50 disabled:pointer-events-none",Gt[a],Wt[s],t),...l}));_.displayName="Button";const te=I.forwardRef(({className:t,...a},s)=>e.jsx("textarea",{ref:s,className:j("flex min-h-[80px] w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 shadow-sm placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:cursor-not-allowed disabled:opacity-50",t),...a}));te.displayName="Textarea";const je=t=>new Promise(a=>setTimeout(a,t)),ye={async searchEquipment(t){if(await je(300),!t)return[];const a=t.toLowerCase();return Object.values(ft).filter(l=>l.label.toLowerCase().includes(a)||l.kapNumber.toLowerCase().includes(a)||l.assetType.toLowerCase().includes(a))},async getAreas(){return await je(100),Object.entries(ut).map(([t,a])=>({id:t,...a}))}};let L=[],Ne=null;const ee=400,z=t=>new Promise(a=>setTimeout(a,t)),ne=t=>{if(Ne!==t){const a=ie(t);L=JSON.parse(JSON.stringify(a.entries)),Ne=t}},$={async getEntries({query:t,status:a,areaId:s,lang:l="en"}){await z(ee),ne(l);let n=[...L];if(a&&a!=="all"&&(n=n.filter(c=>c.status===a)),s&&s!=="all"&&(n=n.filter(c=>c.areaId===s)),t){const c=t.toLowerCase();n=n.filter(d=>d.title.toLowerCase().includes(c)||d.description.toLowerCase().includes(c)||d.equipment.toLowerCase().includes(c)||d.id.toLowerCase().includes(c))}return n.sort((c,d)=>new Date(d.createdAt)-new Date(c.createdAt))},async getEntryById(t,a="en"){await z(ee),ne(a);const s=L.find(l=>l.id===t);if(!s)throw new Error(`Entry ${t} not found`);return s},async createEntry(t,a="en"){await z(ee*2),ne(a);const s=`sb-${Math.floor(Math.random()*1e5)}`,l={...t,id:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),history:[{id:`hist-${Date.now()}`,userId:t.createdById||"user-1",timestamp:new Date().toISOString(),action:"Created entry",status:t.status||"open"}]};return L.unshift(l),l},async updateEntry(t,a){await z(ee);const s=L.findIndex(c=>c.id===t);if(s===-1)throw new Error(`Entry ${t} not found`);const n={...L[s],...a,updatedAt:new Date().toISOString()};return L[s]=n,n},async addChecklistItem(t,a){await z(200);const s=L.find(c=>c.id===t);if(!s)throw new Error(`Entry ${t} not found`);const l={id:`cl-${Date.now()}`,text:a,isDone:!1,doneAt:null,doneById:null},n=[...s.checklist||[],l];return this.updateEntry(t,{checklist:n})},async toggleChecklistItem(t,a,s,l){await z(200);const n=L.find(d=>d.id===t);if(!n)throw new Error(`Entry ${t} not found`);const c=(n.checklist||[]).map(d=>d.id===a?{...d,isDone:s,doneAt:s?new Date().toISOString():null,doneById:s?l:null}:d);return this.updateEntry(t,{checklist:c})},async deleteChecklistItem(t,a){await z(200);const s=L.find(n=>n.id===t);if(!s)throw new Error(`Entry ${t} not found`);const l=(s.checklist||[]).filter(n=>n.id!==a);return this.updateEntry(t,{checklist:l})},async addComment(t,{text:a,authorId:s}){await z(300);const l=L.find(p=>p.id===t);if(!l)throw new Error(`Entry ${t} not found`);const n={id:`com-${Date.now()}`,authorId:s,timestamp:new Date().toISOString(),body:a,mentions:[],parentCommentId:null},c=[...l.comments||[],n],d={id:`hist-${Date.now()}`,userId:s,timestamp:new Date().toISOString(),action:"Commented",status:l.status},h=[...l.history||[],d];return this.updateEntry(t,{comments:c,history:h})},async addAttachment(t,a){await z(1e3);const s=L.find(c=>c.id===t);if(!s)throw new Error(`Entry ${t} not found`);const l={id:`att-${Date.now()}`,filename:a.name,mimeType:a.type,size:"1.2 MB",uploadedAt:new Date().toISOString(),uploadedById:"user-1"},n=[...s.attachments||[],l];return this.updateEntry(t,{attachments:n})}};function Qt({onEntryCreated:t,theme:a,t:s}){const[l,n]=o.useState(!1),[c,d]=o.useState(!1),[h,p]=o.useState(""),[u,b]=o.useState("record"),[g,v]=o.useState(""),[y,N]=o.useState(""),[x,C]=o.useState(null),[m,f]=o.useState(""),[w,B]=o.useState([]),[T,D]=o.useState([]),[F,H]=o.useState(""),[K,M]=o.useState([]),[G,S]=o.useState(!1),[k,P]=o.useState([]);o.useEffect(()=>{l&&(p(""),b("record"),v(""),N(""),C(null),f(""),M([]),B([]),D([]),H(""),ye.getAreas().then(P))},[l]),o.useEffect(()=>{const r=setTimeout(async()=>{if(y.trim().length>1&&!x){S(!0);try{const E=await ye.searchEquipment(y);M(E)}catch(E){console.error(E)}finally{S(!1)}}else M([])},300);return()=>clearTimeout(r)},[y,x]);const Q=r=>{C(r),N(`${r.label} (${r.kapNumber})`),v(r.areaId),M([])},Y=()=>{C(null),N(""),M([])},le=r=>{const E=r.target.files[0];if(!E)return;const W={id:`temp-${Date.now()}`,file:E,name:E.name,size:E.size,type:E.type.startsWith("image/")?"image":"file"};B(dt=>[...dt,W]),r.target.value=null},i=r=>{B(E=>E.filter(W=>W.id!==r))},A=()=>{F.trim()&&(D(r=>[...r,{id:`temp-cl-${Date.now()}`,text:F,isDone:!1}]),H(""))},O=r=>{D(E=>E.filter(W=>W.id!==r))},ct=async()=>{if(!(!h||!m)){d(!0);try{const r=await $.createEntry({title:h,type:u,description:m,areaId:g||"area-1",equipmentId:x?.id||null,equipment:x?`${x.label} (${x.kapNumber})`:y,status:"open",priority:"normal",createdById:"user-1",checklist:T,comments:[],attachments:[],tags:[]});if(w.length>0)for(const W of w)await $.addAttachment(r.id,W.file);const E=await $.getEntryById(r.id);t&&t(E),n(!1)}catch(r){console.error("Failed to create entry",r)}finally{d(!1)}}},ot=r=>{const E=`type${r.charAt(0).toUpperCase()+r.slice(1)}`;return s[E]||r};return e.jsxs(We,{open:l,onOpenChange:n,children:[e.jsx(Vt,{asChild:!0,children:e.jsxs(_,{size:"sm",className:"gap-1.5",children:[e.jsx($t,{className:"h-4 w-4"}),s.newEntry]})}),e.jsxs(he,{className:"sm:max-w-[600px]",theme:a,children:[e.jsxs(Kt,{children:[e.jsx(Xe,{children:s.createHandoverEntry}),e.jsx(Ye,{children:s.dialogSubtitle})]}),e.jsxs(xe,{defaultValue:"general",className:"mt-2",children:[e.jsxs(se,{children:[e.jsx(R,{value:"general",children:s.tabGeneral}),e.jsxs(R,{value:"attachments",className:"flex items-center justify-center gap-2",children:[s.attachments,w.length>0&&e.jsx("span",{className:"flex h-4 min-w-4 items-center justify-center rounded-full bg-sky-500/20 px-1 text-[9px] font-bold text-sky-400",children:w.length})]}),e.jsxs(R,{value:"checklist",className:"flex items-center justify-center gap-2",children:[s.checklistTab,T.length>0&&e.jsx("span",{className:"flex h-4 min-w-4 items-center justify-center rounded-full bg-sky-500/20 px-1 text-[9px] font-bold text-sky-400",children:T.length})]})]}),e.jsxs(V,{value:"general",className:"space-y-4 outline-none",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.labelTitle}),e.jsx(X,{placeholder:s.titlePlaceholder,value:h,onChange:r=>p(r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.labelType}),e.jsx("div",{className:"flex rounded-md bg-slate-900/50 p-1 border border-slate-800",children:["record","instruction","suggestion"].map(r=>e.jsx("button",{type:"button",onClick:()=>b(r),className:`flex-1 rounded px-2 py-1 text-[10px] font-medium capitalize transition-colors ${u===r?"bg-slate-800 text-slate-100 shadow-sm":"text-slate-400 hover:text-slate-300"}`,children:ot(r)},r))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.labelArea}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full h-9 rounded-md border border-slate-800 bg-slate-950 px-3 py-1 text-xs shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-300",value:g,onChange:r=>v(r.target.value),disabled:!!x,children:[e.jsx("option",{value:"",children:s.selectArea}),k.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),x&&e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-sky-400 font-medium",children:s.autoFilled})]})]})]}),e.jsxs("div",{className:"space-y-1.5 relative",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.labelEquipment}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-2.5 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-500"}),e.jsx(X,{placeholder:s.searchPlaceholder,value:y,onChange:r=>{N(r.target.value),x&&C(null)},className:`pl-8 ${x?"text-sky-300 border-sky-500/50":""}`}),G&&e.jsx("div",{className:"absolute right-8 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"block h-3 w-3 rounded-full border-2 border-sky-500 border-t-transparent animate-spin"})}),x&&e.jsx("button",{type:"button",onClick:Y,className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-200",children:e.jsx(Te,{className:"h-3.5 w-3.5"})})]}),K.length>0&&!x&&e.jsx("div",{className:"absolute z-50 mt-1 w-full rounded-md border border-slate-800 bg-slate-950 shadow-xl max-h-48 overflow-y-auto",children:K.map(r=>e.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 text-xs hover:bg-slate-900 border-b border-slate-900 last:border-0 flex flex-col gap-0.5 transition-colors",onClick:()=>Q(r),children:[e.jsx("span",{className:"font-medium text-slate-200",children:r.label}),e.jsxs("span",{className:"flex items-center gap-2 text-[10px] text-slate-500",children:[e.jsx("span",{className:"font-mono",children:r.kapNumber}),e.jsx("span",{children:"•"}),e.jsx("span",{children:r.assetType})]})]},r.kapNumber))})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.labelDescription}),e.jsx(te,{className:"min-h-[120px] font-sans",placeholder:s.descPlaceholder,value:m,onChange:r=>f(r.target.value)})]})]}),e.jsxs(V,{value:"attachments",className:"space-y-4 outline-none min-h-[300px]",children:[e.jsxs("div",{className:"relative rounded-lg border border-dashed border-slate-800 bg-slate-900/30 p-6 text-center transition-colors hover:bg-slate-900/50",children:[e.jsx("div",{className:"mx-auto flex h-10 w-10 items-center justify-center rounded-full bg-slate-900 mb-3",children:e.jsx(Le,{className:"h-5 w-5 text-slate-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-300",children:s.dropFiles}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"Images, PDF, Video (max 20MB)"}),e.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:le})]}),w.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500",children:s.pendingUploads}),e.jsx("div",{className:"space-y-1",children:w.map(r=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border border-slate-800 bg-slate-900/50 px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:`h-8 w-8 rounded flex items-center justify-center shrink-0 ${r.type==="image"?"bg-indigo-500/20":"bg-slate-800"}`,children:r.type==="image"?e.jsx(Z,{className:"h-4 w-4 text-indigo-400"}):e.jsx(kt,{className:"h-4 w-4 text-slate-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-xs font-medium text-slate-200",children:r.name}),e.jsx("p",{className:"text-[10px] text-slate-500",children:Ie(r.size)})]})]}),e.jsx("button",{onClick:()=>i(r.id),className:"ml-2 rounded-full p-1 text-slate-500 hover:bg-slate-800 hover:text-red-400 transition-colors",children:e.jsx(re,{className:"h-3.5 w-3.5"})})]},r.id))})]})]}),e.jsxs(V,{value:"checklist",className:"space-y-4 outline-none min-h-[300px]",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(X,{placeholder:s.addChecklistItem,value:F,onChange:r=>H(r.target.value),onKeyDown:r=>r.key==="Enter"&&A()}),e.jsx(_,{size:"sm",variant:"secondary",onClick:A,children:e.jsx(ze,{className:"h-4 w-4"})})]}),T.length>0?e.jsx("div",{className:"space-y-1",children:T.map(r=>e.jsxs("div",{className:"group flex items-center gap-2 rounded-md bg-slate-900 px-3 py-2 text-xs text-slate-200 border border-transparent hover:border-slate-800",children:[e.jsx(fe,{className:"h-3.5 w-3.5 text-slate-500"}),e.jsx("span",{className:"flex-1",children:r.text}),e.jsx("button",{onClick:()=>O(r.id),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-400 transition-opacity",children:e.jsx(re,{className:"h-3.5 w-3.5"})})]},r.id))}):e.jsxs("div",{className:"flex h-32 flex-col items-center justify-center rounded-lg border border-dashed border-slate-800 bg-slate-900/20 text-slate-500",children:[e.jsx(fe,{className:"mb-2 h-5 w-5 opacity-50"}),e.jsx("p",{className:"text-xs",children:s.noItemsAdded})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2 border-t border-slate-800 pt-4",children:[e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>n(!1),children:s.cancel}),e.jsx(_,{size:"sm",onClick:ct,disabled:c||!h||!m,children:c?s.btnCreating:s.btnCreate})]})]})]})}const ve={open:{label:U.open,badgeVariant:"warning"},in_progress:{label:U.in_progress,badgeVariant:"secondary"},completed:{label:U.completed,badgeVariant:"success"},cancelled:{label:U.cancelled,badgeVariant:"muted"}},we={high:"text-red-400",medium:"text-amber-300",normal:"text-emerald-300",low:"text-slate-300"};function Xt(t,a){const s=ve[t.status]||ve.open,l=`status${t.status.charAt(0).toUpperCase()+t.status.slice(1).replace("_","")}`;return{text:a[l]||s.label,variant:s.badgeVariant}}function Yt(t,a){const s=we[t.priority]||we.normal,l=`priority${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`,n=a[l]||t.priority;return{tone:s,label:n}}function Jt(t,a){const s=`type${t.type.charAt(0).toUpperCase()+t.type.slice(1)}`;return a[s]||t.type}function Zt({entry:t,active:a,onSelect:s,users:l,areas:n,t:c}){const{text:d,variant:h}=Xt(t,c),p=Yt(t,c),u=n[t.areaId]||{name:"Unknown area"},b=l[t.createdById]||{name:"Unknown"};return e.jsxs("button",{type:"button",onClick:()=>s(t),className:["slv4-entry-row w-full rounded-lg border px-3 py-3 text-left transition-all","flex flex-col gap-2 bg-slate-900/40 hover:bg-slate-900/70",a?"border-primary/80 shadow-[0_0_0_1px_rgba(59,130,246,0.7)]":"border-slate-800/80 hover:border-slate-700"].join(" "),children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{variant:h,className:"mt-0.5",children:d}),e.jsx("span",{className:["text-[11px] font-medium tracking-wide uppercase rounded-full bg-slate-800/70 px-2 py-0.5",p.tone].join(" "),children:p.label}),e.jsxs("span",{className:"ml-auto inline-flex items-center gap-1 text-[11px] text-slate-400",children:[e.jsx(oe,{className:"h-3 w-3"}),Ht(t.createdAt)]})]}),e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[11px] font-mono text-slate-400",children:t.id}),e.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-800/70 px-2 py-0.5 text-[11px] text-sky-300",children:Jt(t,c)})]}),e.jsx("h3",{className:"mt-1 line-clamp-2 text-sm font-medium text-slate-50",children:t.title}),e.jsx("p",{className:"mt-1 line-clamp-2 text-xs text-slate-400",children:t.description})]})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-slate-400",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-800/70 px-2 py-0.5",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:u.name})]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-slate-800/70 px-2 py-0.5",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{children:t.equipment})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(De,{className:"h-3 w-3"}),e.jsx("span",{children:b.name})]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),e.jsx("span",{children:J(t.createdAt)})]})]})]})]})}function es({t,entries:a,selectedId:s,onSelect:l,query:n,setQuery:c,statusFilter:d,setStatusFilter:h,areaFilter:p,setAreaFilter:u,onEntryCreated:b,theme:g,language:v}){const y=ie(v),N=y.areas,x=y.users,C=[{id:"all",name:t.allAreas},...Object.entries(N).map(([m,f])=>({id:m,name:f.name}))];return e.jsxs("div",{className:"flex flex-col gap-4 w-full md:w-[40%]",children:[e.jsxs("section",{className:"slv4-panel flex flex-wrap items-center gap-3 rounded-xl border border-slate-900 bg-slate-950/80 px-4 py-3",children:[e.jsx("div",{className:"flex-1 min-w-[220px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"pointer-events-none absolute left-2.5 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-500"}),e.jsx(X,{value:n,onChange:m=>c(m.target.value),placeholder:t.searchPlaceholder,className:"h-9 border-slate-800 bg-slate-950 pl-8 text-xs placeholder:text-slate-500"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsx(xe,{value:d,onValueChange:h,className:"rounded-full bg-slate-900/80 px-1 py-0.5",children:e.jsxs(se,{className:"bg-transparent p-0",children:[e.jsx(R,{value:"open",children:t.statusOpen}),e.jsx(R,{value:"in_progress",children:t.statusInProgress}),e.jsx(R,{value:"completed",children:t.statusCompleted}),e.jsx(R,{value:"all",children:t.statusAll})]})}),e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-900/80 px-3 py-1",children:[e.jsx(oe,{className:"h-3.5 w-3.5 text-slate-300"}),e.jsx("span",{children:t.last24Hours}),e.jsx(Ct,{className:"h-3 w-3 text-slate-500"})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-900/80 px-3 py-1",children:[e.jsx(Ae,{className:"h-3.5 w-3.5 text-slate-300"}),e.jsx("select",{value:p,onChange:m=>u(m.target.value),className:"bg-transparent text-xs outline-none",children:C.map(m=>e.jsx("option",{value:m.id,className:"bg-slate-950 text-slate-100",children:m.name},m.id))})]}),e.jsx(Qt,{onEntryCreated:b,theme:g,t})]})]}),e.jsxs("div",{className:"slv4-panel flex w-full flex-col rounded-xl border border-slate-900 bg-slate-950/80 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-900 px-3 py-2 text-[11px] text-slate-400",children:[e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{children:t.entriesTitle})]}),e.jsx("div",{className:"inline-flex items-center gap-2",children:e.jsxs("span",{children:[a.length," ",t.visibleSuffix]})})]}),e.jsxs("div",{className:"space-y-2 p-3 overflow-y-auto flex-1 max-h-[calc(100vh-300px)]",children:[a.map(m=>e.jsx(Zt,{entry:m,active:s===m.id,onSelect:l,users:x,areas:N,t},m.id)),a.length===0&&e.jsx("div",{className:"flex h-40 items-center justify-center rounded-lg border border-dashed border-slate-800 bg-slate-950/80 text-xs text-slate-500",children:t.noEntriesMatch})]})]})]})}var ae="Checkbox",[ts]=St(ae),[ss,pe]=ts(ae);function as(t){const{__scopeCheckbox:a,checked:s,children:l,defaultChecked:n,disabled:c,form:d,name:h,onCheckedChange:p,required:u,value:b="on",internal_do_not_use_render:g}=t,[v,y]=At({prop:s,defaultProp:n??!1,onChange:p,caller:ae}),[N,x]=o.useState(null),[C,m]=o.useState(null),f=o.useRef(!1),w=N?!!d||!!N.closest("form"):!0,B={checked:v,disabled:c,setChecked:y,control:N,setControl:x,name:h,form:d,value:b,hasConsumerStoppedPropagationRef:f,required:u,defaultChecked:q(n)?!1:n,isFormControl:w,bubbleInput:C,setBubbleInput:m};return e.jsx(ss,{scope:a,...B,children:ls(g)?g(B):l})}var Je="CheckboxTrigger",Ze=o.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:s,...l},n)=>{const{control:c,value:d,disabled:h,checked:p,required:u,setControl:b,setChecked:g,hasConsumerStoppedPropagationRef:v,isFormControl:y,bubbleInput:N}=pe(Je,t),x=Ue(n,b),C=o.useRef(p);return o.useEffect(()=>{const m=c?.form;if(m){const f=()=>g(C.current);return m.addEventListener("reset",f),()=>m.removeEventListener("reset",f)}},[c,g]),e.jsx(de.button,{type:"button",role:"checkbox","aria-checked":q(p)?"mixed":p,"aria-required":u,"data-state":lt(p),"data-disabled":h?"":void 0,disabled:h,value:d,...l,ref:x,onKeyDown:be(a,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:be(s,m=>{g(f=>q(f)?!0:!f),N&&y&&(v.current=m.isPropagationStopped(),v.current||m.stopPropagation())})})});Ze.displayName=Je;var ue=o.forwardRef((t,a)=>{const{__scopeCheckbox:s,name:l,checked:n,defaultChecked:c,required:d,disabled:h,value:p,onCheckedChange:u,form:b,...g}=t;return e.jsx(as,{__scopeCheckbox:s,checked:n,defaultChecked:c,disabled:h,required:d,onCheckedChange:u,name:l,form:b,value:p,internal_do_not_use_render:({isFormControl:v})=>e.jsxs(e.Fragment,{children:[e.jsx(Ze,{...g,ref:a,__scopeCheckbox:s}),v&&e.jsx(at,{__scopeCheckbox:s})]})})});ue.displayName=ae;var et="CheckboxIndicator",tt=o.forwardRef((t,a)=>{const{__scopeCheckbox:s,forceMount:l,...n}=t,c=pe(et,s);return e.jsx(Et,{present:l||q(c.checked)||c.checked===!0,children:e.jsx(de.span,{"data-state":lt(c.checked),"data-disabled":c.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...t.style}})})});tt.displayName=et;var st="CheckboxBubbleInput",at=o.forwardRef(({__scopeCheckbox:t,...a},s)=>{const{control:l,hasConsumerStoppedPropagationRef:n,checked:c,defaultChecked:d,required:h,disabled:p,name:u,value:b,form:g,bubbleInput:v,setBubbleInput:y}=pe(st,t),N=Ue(s,y),x=It(c),C=Lt(l);o.useEffect(()=>{const f=v;if(!f)return;const w=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(w,"checked").set,D=!n.current;if(x!==c&&T){const F=new Event("click",{bubbles:D});f.indeterminate=q(c),T.call(f,q(c)?!1:c),f.dispatchEvent(F)}},[v,x,c,n]);const m=o.useRef(q(c)?!1:c);return e.jsx(de.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??m.current,required:h,disabled:p,name:u,value:b,form:g,...a,tabIndex:-1,ref:N,style:{...a.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});at.displayName=st;function ls(t){return typeof t=="function"}function q(t){return t==="indeterminate"}function lt(t){return q(t)?"indeterminate":t?"checked":"unchecked"}const nt=I.forwardRef(({className:t,...a},s)=>e.jsx(ue,{ref:s,className:j("peer h-4 w-4 shrink-0 rounded-sm border border-slate-600 bg-slate-950 text-slate-50 ring-offset-slate-950 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-500",t),...a,children:e.jsx(tt,{className:"flex items-center justify-center text-current",children:e.jsx(Rt,{className:"h-3 w-3"})})}));nt.displayName=ue.displayName;const rt=I.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:j("slv4-card rounded-xl border border-slate-800 shadow-sm",t),...a}));rt.displayName="Card";const ns=({className:t,...a})=>e.jsx("div",{className:j("flex flex-col gap-1.5 border-b border-slate-800 px-4 py-3",t),...a}),rs=({className:t,...a})=>e.jsx("h3",{className:j("text-sm font-semibold leading-tight",t),...a}),is=({className:t,...a})=>e.jsx("p",{className:j("text-xs text-slate-400",t),...a}),cs=({className:t,...a})=>e.jsx("div",{className:j("px-4 py-3 text-sm",t),...a}),os=({className:t,...a})=>e.jsx("div",{className:j("flex items-center justify-between gap-2 border-t border-slate-800 px-4 py-3",t),...a}),it=I.forwardRef(({className:t,children:a,...s},l)=>e.jsxs(Ve,{ref:l,className:j("relative overflow-hidden",t),...s,children:[e.jsx(Tt,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(Dt,{orientation:"vertical",className:"flex touch-none select-none flex-col bg-slate-950/80 p-0.5",children:e.jsx(Pt,{className:"relative flex-1 rounded-full bg-slate-700"})})]}));it.displayName=Ve.displayName;const ke={open:{label:U.open,badgeVariant:"warning",labelKey:"statusOpen"},in_progress:{label:U.in_progress,badgeVariant:"secondary",labelKey:"statusInProgress"},completed:{label:U.completed,badgeVariant:"success",labelKey:"statusCompleted"},cancelled:{label:U.cancelled,badgeVariant:"muted",labelKey:"statusAll"}},Ce={high:"text-red-400",medium:"text-amber-300",normal:"text-emerald-300",low:"text-slate-300"};function ds(t,a){const s=ke[t.status]||ke.open,l=s.labelKey;return{text:a&&a[l]||s.label,variant:s.badgeVariant}}function ms(t,a){const s=Ce[t.priority]||Ce.normal,l=`priority${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`,n=a&&a[l]||t.priority;return{tone:s,label:n}}function xs(t,a){const s=`type${t.type.charAt(0).toUpperCase()+t.type.slice(1)}`;return a&&a[s]||t.type}function Se({entry:t,onUpdate:a,language:s,t:l}){const n=ie(s),c=n.users,d=n.areas;function h(i){return c[i]||{name:"Unknown"}}function p(i){return d[i]||{name:"Unknown area"}}const u=ds(t,l),b=ms(t,l),g=p(t.areaId),v=h(t.createdById),y=h(t.assignedToId),[N,x]=o.useState(!1),[C,m]=o.useState(t.description||""),[f,w]=o.useState(""),[B,T]=o.useState(!1),[D,F]=o.useState(""),[H,K]=o.useState(!1),[M,G]=o.useState(!1);o.useEffect(()=>{x(!1),m(t.description||""),w(""),F("")},[t.id,t.description]);const S=async()=>{try{const i=await $.updateEntry(t.id,{description:C});a(i),x(!1)}catch(i){console.error("Failed to update description",i)}},k=async(i,A)=>{try{const O=await $.toggleChecklistItem(t.id,i,A,"user-1");a(O)}catch(O){console.error("Failed to toggle checklist",O)}},P=async()=>{if(f.trim()){T(!0);try{const i=await $.addChecklistItem(t.id,f);a(i),w("")}catch(i){console.error("Failed to add checklist item",i)}finally{T(!1)}}},Q=async i=>{try{const A=await $.deleteChecklistItem(t.id,i);a(A)}catch(A){console.error("Failed to delete checklist item",A)}},Y=async()=>{if(D.trim()){K(!0);try{const i=await $.addComment(t.id,{text:D,authorId:"user-1"});a(i),F("")}catch(i){console.error("Failed to post comment",i)}finally{K(!1)}}},le=async i=>{const A=i.target.files[0];if(A){G(!0);try{const O=await $.addAttachment(t.id,A);a(O)}catch(O){console.error("Failed to upload attachment",O)}finally{G(!1)}}};return e.jsxs("div",{className:"slv4-panel flex w-full flex-col rounded-xl border border-slate-900 bg-slate-950/80 md:w-[60%] h-full",children:[e.jsx("div",{className:"mb-2 flex items-center justify-between text-xs text-slate-400 px-1",children:e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx(Ke,{className:"h-3 w-3"}),e.jsx("span",{children:l.entryWorkspace})]})}),e.jsxs(rt,{className:"h-full backdrop-blur border-slate-800 flex flex-col",children:[e.jsxs(ns,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(me,{variant:u.variant,children:u.text}),e.jsx("span",{className:["inline-flex items-center rounded-full bg-slate-900 px-2 py-0.5 text-[11px] font-medium tracking-wide uppercase",b.tone].join(" "),children:b.label})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-xs text-slate-400",children:[e.jsx("span",{className:"font-mono text-[11px] text-slate-500",children:t.id}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:g.name})]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{children:t.equipment})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-400",children:l.createdLabel}),e.jsx("p",{className:"text-xs font-medium text-slate-100",children:J(t.createdAt)}),t.dueAt&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:l.dueLabel}),e.jsx("p",{className:"text-xs font-medium text-slate-100",children:J(t.dueAt)})]})]})]}),e.jsx(rs,{className:"mt-3 text-base text-slate-50",children:t.title}),e.jsxs(is,{className:"text-xs text-slate-300",children:[xs(t,l)," • ",l.shiftHandoverFocus]})]}),e.jsx(cs,{className:"pb-0 flex-1 overflow-hidden flex flex-col",children:e.jsxs(xe,{defaultValue:"details",className:"flex-1 flex flex-col",children:[e.jsxs(se,{children:[e.jsx(R,{value:"details",children:l.detailsTab}),e.jsx(R,{value:"checklist",children:l.checklistTab}),e.jsx(R,{value:"comments",children:l.commentsTab}),e.jsx(R,{value:"history",children:l.historyTab})]}),e.jsx(V,{value:"details",className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"mt-3 space-y-3 text-sm",children:[N?e.jsx(te,{className:"min-h-[120px]",value:C,onChange:i=>m(i.target.value)}):e.jsx("p",{className:"text-slate-100 whitespace-pre-line",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs text-slate-300",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:l.createdBy}),e.jsx("p",{children:v.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-500",children:l.assignedTo}),e.jsx("p",{children:y.name||"—"})]})]}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-400",children:[e.jsx(Le,{className:"h-3 w-3"}),l.attachments]}),e.jsxs("label",{className:"cursor-pointer inline-flex items-center gap-1 rounded bg-slate-800 px-2 py-1 text-[10px] hover:bg-slate-700",children:[e.jsx("input",{type:"file",className:"hidden",onChange:le,disabled:M}),M?"Uploading...":l.addFile]})]}),t.attachments?.length?e.jsx("ul",{className:"space-y-1 text-xs text-slate-300",children:t.attachments.map(i=>e.jsxs("li",{className:"flex items-center justify-between rounded-md bg-slate-900 px-2 py-1",children:[e.jsxs("div",{className:"flex items-center gap-2 truncate",children:[i.type==="image"?e.jsx("div",{className:"h-2 w-2 bg-indigo-400 rounded-full"}):e.jsx("div",{className:"h-2 w-2 bg-slate-500 rounded-full"}),e.jsx("span",{className:"truncate",children:i.filename})]}),e.jsx("span",{className:"ml-2 text-[11px] text-slate-500 whitespace-nowrap",children:i.size||Ie(i.sizeBytes)})]},i.id))}):e.jsx("p",{className:"text-xs text-slate-500 italic",children:l.noAttachments})]})]})}),e.jsx(V,{value:"checklist",className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(X,{size:"sm",placeholder:l.newItemPlaceholder,value:f,onChange:i=>w(i.target.value),onKeyDown:i=>i.key==="Enter"&&P()}),e.jsx(_,{size:"sm",variant:"secondary",onClick:P,disabled:B,children:e.jsx(ze,{className:"h-4 w-4"})})]}),t.checklist?.length?t.checklist.map(i=>e.jsxs("div",{className:"group flex items-center gap-2 rounded-md bg-slate-900 px-2 py-1.5 text-xs text-slate-200",children:[e.jsx(nt,{checked:i.isDone,className:"mt-0.5",onCheckedChange:A=>k(i.id,A)}),e.jsx("span",{className:`flex-1 ${i.isDone?"line-through text-slate-500":""}`,children:i.text}),i.isDone&&i.doneById&&e.jsxs("span",{className:"text-[10px] text-slate-500",children:["by ",h(i.doneById).name.split(" ")[0]]}),e.jsx("button",{onClick:()=>Q(i.id),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-400 transition-opacity",children:e.jsx(re,{className:"h-3 w-3"})})]},i.id)):e.jsx("p",{className:"text-xs text-slate-400",children:l.noChecklistItems})]})}),e.jsx(V,{value:"comments",className:"flex-1 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsx(it,{className:"flex-1 rounded-md border border-slate-800 bg-slate-950/60 mb-3",children:e.jsx("div",{className:"p-3 space-y-3",children:t.comments?.length?t.comments.map(i=>{const A=h(i.authorId);return e.jsxs("div",{className:"rounded-lg bg-slate-900/80 px-3 py-2 text-xs text-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium",children:A.name}),e.jsx("span",{className:"text-[11px] text-slate-400",children:J(i.timestamp)})]}),e.jsx("p",{className:"mt-1 text-slate-200 whitespace-pre-line",children:i.body})]},i.id)}):e.jsx("p",{className:"px-2 py-4 text-center text-[11px] text-slate-500",children:l.noComments})})}),e.jsxs("div",{className:"flex items-end gap-2 text-xs",children:[e.jsx(te,{placeholder:l.typeCommentPlaceholder,className:"min-h-[60px] bg-slate-950/60",value:D,onChange:i=>F(i.target.value)}),e.jsx(_,{type:"button",size:"sm",variant:"secondary",className:"whitespace-nowrap h-[60px]",onClick:Y,disabled:H||!D.trim(),children:e.jsx(Bt,{className:"h-4 w-4"})})]})]})}),e.jsx(V,{value:"history",className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"mt-3 space-y-2 text-xs text-slate-300",children:t.history?.length?t.history.map(i=>e.jsxs("div",{className:"flex items-start gap-2 rounded-md bg-slate-900 px-2 py-1.5",children:[e.jsx("div",{className:"mt-0.5 h-1.5 w-1.5 rounded-full bg-sky-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:h(i.userId)?.name}),e.jsx("p",{className:"text-slate-200",children:i.action})]}),e.jsx("span",{className:"text-[11px] text-slate-500",children:J(i.timestamp)})]},i.id)):e.jsx("p",{className:"text-xs text-slate-400",children:l.historyPlaceholder})})})]})}),e.jsxs(os,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx(qe,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.checklist?.filter(i=>i.isDone).length||0,"/",t.checklist?.length||0," ",l.itemsComplete]})]}),e.jsx("div",{className:"flex items-center gap-2",children:N?e.jsxs(e.Fragment,{children:[e.jsx(_,{size:"sm",variant:"ghost",className:"text-slate-300",onClick:()=>{x(!1),m(t.description||"")},children:l.cancel}),e.jsx(_,{size:"sm",variant:"secondary",onClick:S,children:l.saveChanges})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{size:"sm",variant:"secondary",onClick:()=>x(!0),children:l.editDescription}),e.jsx(_,{size:"sm",variant:"ghost",className:"text-slate-300",children:l.handoverComplete})]})})]})]})]})}class hs extends I.Component{constructor(a){super(a),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){console.error("Uncaught error:",a,s),this.setState({error:a,errorInfo:s})}render(){return this.state.hasError?e.jsxs("div",{className:"p-8 text-red-400 bg-slate-950 min-h-screen font-mono",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"Something went wrong."}),e.jsx("pre",{className:"text-xs whitespace-pre-wrap bg-slate-900 p-4 rounded mb-4 border border-red-900",children:this.state.error&&this.state.error.toString()}),e.jsxs("details",{className:"text-xs text-slate-500",children:[e.jsx("summary",{children:"Stack Trace"}),e.jsx("pre",{className:"mt-2 whitespace-pre-wrap",children:this.state.errorInfo&&this.state.errorInfo.componentStack})]})]}):this.props.children}}const Ee={en:{headerKicker:"BLMS • Shift Book",headerTitle:"Handover cockpit",headerTagline:"Shift handover and operational logging",densityLabel:"Density",shiftLabel:"Shift B • Aarberg",searchPlaceholder:"Search by title, equipment, KAP, or free text…",statusOpen:"Open",statusInProgress:"In progress",statusCompleted:"Completed",statusAll:"All",last24Hours:"Last 24 hours",allAreas:"All areas",entriesTitle:"Entries",visibleSuffix:"visible",workspaceTitle:"Entry workspace",workspaceHint:"",newEntry:"New handover entry",blmsNavTitle:"BLMS navigation",themeDark:"Dark",themeLight:"Light",langEn:"EN",langDe:"DE",editEntry:"Edit entry",handoverComplete:"Handover complete",saveChanges:"Save changes",cancel:"Cancel",createdLabel:"Created",dueLabel:"Due",priorityHigh:"High Priority",priorityNormal:"Normal Priority",priorityMedium:"Medium Priority",priorityLow:"Low Priority",typeRecord:"Record",typeInstruction:"Instruction",typeSuggestion:"Suggestion",shiftHandoverFocus:"Shift handover focus",detailsTab:"Details",checklistTab:"Checklist",commentsTab:"Comments",historyTab:"History",createdBy:"Created by",assignedTo:"Assigned to",attachments:"Attachments",addFile:"Add file",noAttachments:"No attachments.",itemsComplete:"items complete",noChecklistItems:"No checklist items attached to this entry.",noComments:"No comments yet — next shift can add notes here.",historyPlaceholder:"History trail would appear here.",typeCommentPlaceholder:"Type a comment...",newItemPlaceholder:"New item...",createHandoverEntry:"Create handover entry",dialogSubtitle:"Complete the form below. Attachments and checklist items can be added immediately.",tabGeneral:"General",labelTitle:"Title",labelType:"Type",labelArea:"Area",labelEquipment:"Equipment / KAP",labelDescription:"Description / actions",dropFiles:"Drop files here or click to upload",pendingUploads:"Pending Uploads",addChecklistItem:"Add checklist item...",noItemsAdded:"No items added yet",btnCreate:"Create Entry",btnCreating:"Creating...",titlePlaceholder:"Short, action-oriented subject",descPlaceholder:"What happened? What should the next shift continue or verify?",selectArea:"Select Area...",autoFilled:"Auto-filled",noEntriesMatch:"No entries match this filter."},de:{headerKicker:"BLMS • Schichtbuch",headerTitle:"Übergabecockpit",headerTagline:"Schichtübergabe und betriebliche Protokollierung",densityLabel:"Dichte",shiftLabel:"Schicht B • Aarberg",searchPlaceholder:"Nach Titel, Anlage, KAP oder Freitext suchen…",statusOpen:"Offen",statusInProgress:"In Bearbeitung",statusCompleted:"Abgeschlossen",statusAll:"Alle",last24Hours:"Letzte 24 Stunden",allAreas:"Alle Bereiche",entriesTitle:"Einträge",visibleSuffix:"sichtbar",workspaceTitle:"Eintragsarbeitsbereich",workspaceHint:"",newEntry:"Neue Übergabe",blmsNavTitle:"BLMS-Navigation",themeDark:"Dunkel",themeLight:"Hell",langEn:"EN",langDe:"DE",editEntry:"Eintrag bearbeiten",handoverComplete:"Übergabe erledigt",saveChanges:"Änderungen speichern",cancel:"Abbrechen",createdLabel:"Erstellt",dueLabel:"Fällig",priorityHigh:"Hohe Priorität",priorityNormal:"Normale Priorität",priorityMedium:"Mittlere Priorität",priorityLow:"Niedrige Priorität",typeRecord:"Eintrag",typeInstruction:"Anweisung",typeSuggestion:"Vorschlag",shiftHandoverFocus:"Fokus Schichtübergabe",detailsTab:"Details",checklistTab:"Checkliste",commentsTab:"Kommentare",historyTab:"Verlauf",createdBy:"Erstellt von",assignedTo:"Zugewiesen an",attachments:"Anhänge",addFile:"Datei hinzufügen",noAttachments:"Keine Anhänge.",itemsComplete:"Elemente erledigt",noChecklistItems:"Keine Checklisten-Elemente an diesem Eintrag.",noComments:"Noch keine Kommentare — die nächste Schicht kann hier Notizen hinzufügen.",historyPlaceholder:"Verlauf würde hier erscheinen.",typeCommentPlaceholder:"Kommentar eingeben...",newItemPlaceholder:"Neues Element...",createHandoverEntry:"Übergabeeintrag erstellen",dialogSubtitle:"Füllen Sie das Formular aus. Anhänge und Checklisten können sofort hinzugefügt werden.",tabGeneral:"Allgemein",labelTitle:"Titel",labelType:"Typ",labelArea:"Bereich",labelEquipment:"Anlage / KAP",labelDescription:"Beschreibung / Maßnahmen",dropFiles:"Dateien hier ablegen oder klicken zum Hochladen",pendingUploads:"Ausstehende Uploads",addChecklistItem:"Checklisten-Element hinzufügen...",noItemsAdded:"Noch keine Elemente",btnCreate:"Eintrag erstellen",btnCreating:"Erstelle...",titlePlaceholder:"Kurzer, handlungsorientierter Betreff",descPlaceholder:"Was ist passiert? Was soll die nächste Schicht fortsetzen oder prüfen?",selectArea:"Bereich wählen...",autoFilled:"Automatisch ausgefüllt",noEntriesMatch:"Keine Einträge entsprechen diesem Filter."}};function Ms(){return e.jsx(hs,{children:e.jsx(ps,{})})}function ps(){const[t,a]=o.useState("dark"),[s,l]=o.useState("en"),n=Ee[s]||Ee.en,[c,d]=o.useState([]),[h,p]=o.useState(!0),[u,b]=o.useState(null),[g,v]=o.useState(""),[y,N]=o.useState("open"),[x,C]=o.useState("all"),[m,f]=o.useState(0),[w,B]=o.useState(!1),[T,D]=o.useState(!1),[F,H]=o.useState(!1);o.useEffect(()=>{if(typeof window>"u")return;const S=window.matchMedia("(max-width: 767px)"),k=P=>B(P.matches);return k(S),S.addEventListener("change",k),()=>S.removeEventListener("change",k)},[]),o.useEffect(()=>{(async()=>{p(!0);try{const k=await $.getEntries({query:g,status:y,areaId:x,lang:s});d(k),b(P=>{if(P){const Q=k.find(Y=>Y.id===P.id);if(Q)return Q}return k.length>0?k[0]:null})}catch(k){console.error("Failed to load entries",k)}finally{p(!1)}})()},[g,y,x,m,s]);const K=S=>{b(S),w&&D(!0)},M=S=>{f(k=>k+1),b(S)},G=S=>{d(k=>k.map(P=>P.id===S.id?S:P)),b(S)};return e.jsxs("div",{className:`shiftlog-v4 ${t==="light"?"is-light":"is-dark"} flex min-h-screen flex-col bg-slate-950 text-slate-50`,children:[e.jsx(zt,{t:n,theme:t,setTheme:a,language:s,setLanguage:l}),e.jsxs("main",{className:"mx-auto flex w-full max-w-6xl flex-1 flex-col gap-4 px-6 py-4 md:flex-row",children:[e.jsx(es,{t:n,entries:c,selectedId:u?.id,onSelect:K,query:g,setQuery:v,statusFilter:y,setStatusFilter:N,areaFilter:x,setAreaFilter:C,onEntryCreated:M,theme:t,language:s}),u?e.jsx(Se,{entry:u,onUpdate:G,language:s,t:n}):e.jsx("div",{className:"slv4-panel flex w-full flex-col rounded-xl border border-slate-900 bg-slate-950/80 md:w-[60%] h-full items-center justify-center text-slate-500 text-xs border-dashed",children:h?"Loading...":"Pick an entry on the left to open its workspace."})]}),w&&!T&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>H(!0),className:"fixed bottom-4 right-4 z-40 inline-flex items-center gap-2 rounded-full bg-sky-600 px-3 py-2 text-xs font-semibold text-white shadow-lg md:hidden",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:"BLMS"})]}),F&&e.jsx("div",{className:"fixed inset-0 z-40 flex items-end justify-center bg-black/40 md:hidden",children:e.jsxs("div",{className:"mb-4 w-full max-w-sm rounded-2xl border border-slate-800 bg-slate-950 p-3 shadow-xl",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-xs text-slate-400",children:[e.jsx("span",{className:"font-semibold text-slate-100",children:n.blmsNavTitle}),e.jsx("button",{type:"button",onClick:()=>H(!1),className:"rounded-full px-2 py-1 text-[11px] text-slate-300 hover:bg-slate-800",children:"Close"})]}),e.jsx(Ge,{activeId:"shift-book",orientation:"vertical"})]})})]}),w&&e.jsx(We,{open:T,onOpenChange:D,children:e.jsx(he,{className:"max-h-[90vh] w-full max-w-md overflow-y-auto p-0",theme:t,children:u&&e.jsx(Se,{entry:u,onUpdate:G,language:s})})})]})}export{Ms as default};
